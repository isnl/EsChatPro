<div align="center">

<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 32 32"><g fill="none"><path fill="#F8312F" d="M5 3.5a1.5 1.5 0 0 1-1 1.415V12l2.16 5.487L4 23c-1.1 0-2-.9-2-1.998v-7.004a2 2 0 0 1 1-1.728V4.915A1.5 1.5 0 1 1 5 3.5Zm25.05.05c0 .681-.44 1.26-1.05 1.468V12.2c.597.347 1 .994 1 1.73v7.01c0 1.1-.9 2-2 2l-2.94-5.68L28 11.93V5.018a1.55 1.55 0 1 1 2.05-1.468Z"></path><path fill="#FFB02E" d="M11 4.5A1.5 1.5 0 0 1 12.5 3h7a1.5 1.5 0 0 1 .43 2.938c-.277.082-.57.104-.847.186l-3.053.904l-3.12-.908c-.272-.08-.56-.1-.832-.18A1.5 1.5 0 0 1 11 4.5Z"></path><path fill="#CDC4D6" d="M22.05 30H9.95C6.66 30 4 27.34 4 24.05V12.03C4 8.7 6.7 6 10.03 6h11.95C25.3 6 28 8.7 28 12.03v12.03c0 3.28-2.66 5.94-5.95 5.94Z"></path><path fill="#212121" d="M9.247 18.5h13.506c2.33 0 4.247-1.919 4.247-4.25A4.257 4.257 0 0 0 22.753 10H9.247A4.257 4.257 0 0 0 5 14.25a4.257 4.257 0 0 0 4.247 4.25Zm4.225 7.5h5.056C19.34 26 20 25.326 20 24.5s-.66-1.5-1.472-1.5h-5.056C12.66 23 12 23.674 12 24.5s.66 1.5 1.472 1.5Z"></path><path fill="#00A6ED" d="M10.25 12C9.56 12 9 12.56 9 13.25v2.5a1.25 1.25 0 1 0 2.5 0v-2.5c0-.69-.56-1.25-1.25-1.25Zm11.5 0c-.69 0-1.25.56-1.25 1.25v2.5a1.25 1.25 0 1 0 2.5 0v-2.5c0-.69-.56-1.25-1.25-1.25Z"></path></g></svg>

# `EsChatPro` <!-- omit in toc -->

![GitHub top language](https://img.shields.io/github/languages/top/isnl/EsChatPro)
![GitHub last commit](https://img.shields.io/github/last-commit/isnl/EsChatPro)
[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](https://opensource.org/licenses/MIT)

<p class="align center">
<h4>ä¸€ä¸ªå¼€ç®±å³ç”¨ä¸”ææ˜“ä¸Šæ‰‹çš„ç±»ChatGPT/é€šä¹‰åƒé—®/æ–‡å¿ƒä¸€è¨€çš„å•†ä¸šå¼€æºåº”ç”¨<br>å¯æ¥å…¥ä»»ä½• <code>OpenAIæ¥å£å…¼å®¹çš„å¤§è¯­è¨€æ¨¡å‹</code></h4>
</p>
</div>

## ç³»åˆ—æ–‡ç«  <!-- omit in toc -->

- [æœ¬åœ°å¼€å‘è¿è¡ŒæŒ‡å—](./docs/æœ¬åœ°å¼€å‘è¿è¡ŒæŒ‡å—.md)
- [æ¥å…¥å¤§æ¨¡å‹æ•™ç¨‹](./docs/æ¥å…¥å¤§æ¨¡å‹æ•™ç¨‹.md)

## ç‰ˆæœ¬ç‰¹æ€§ <!-- omit in toc -->

- [x] å¯æ¥å…¥ä»»ä½•ä¸»æµ `OpendAIæ¥å£å…¼å®¹` çš„ AI å¤§è¯­è¨€æ¨¡å‹
- [x] æ”¯æŒæš—é»‘ä¸»é¢˜ ğŸŒ™
- [x] å®Œç¾çš„ç§»åŠ¨ç«¯å…¼å®¹ ğŸ“±
- [x] æ‰“å­—æœºå›å¤æ•ˆæœ âŒ¨ï¸
- [x] ä¸Šä¸‹æ–‡å¯¹è¯æ”¯æŒï¼Œå¯åˆ›å»ºå¤šè½®å¯¹è¯è®°å½•
- [x] è‡ªå®šä¹‰ç³»ç»Ÿè§’è‰²
- [x] æ•´æ®µç”Ÿæˆå†…å®¹æ”¯æŒå¤åˆ¶ã€ä»£ç å¤åˆ¶ã€ä»£ç é«˜äº®
- [x] åŒç™»å½•æ¨¡å¼ï¼š
  - 1.å…³è”å…¬ä¼—å·ç™»å½•(ä¸ªäººè®¢é˜…å·å³å¯)
  - 2.æ™®é€šçš„æˆæƒç ç™»å½•æ¨¡å¼(æ‰‹åŠ¨åˆ†å‘æˆæƒç )
- [x] è‡ªå®šä¹‰è°ƒç”¨æ¬¡æ•°åŠæ–‡æœ¬è¾“å…¥ä¸Šé™
- [x] MongoDB æ•°æ®åº“
- [x] åå°ä»ªè¡¨ç›˜ï¼šä½¿ç”¨åˆ†æã€ç”¨æˆ·æ¦‚è§ˆã€è°ƒç”¨æ—¥å†
- [x] ç”¨æˆ·ç®¡ç†
- [x] å•†ä¸šåŒ–-VIP ä¼šå‘˜ç®¡ç†
- [x] å•†ä¸šåŒ–-VIP ç”¨æˆ·å¡å¯†ç®¡ç†ï¼šç”Ÿæˆã€æ¿€æ´»
- [x] ç”Ÿæˆå†…å®¹åˆ†äº«ç®¡ç†ï¼Œç±»ä¼¼äºç™¾åº¦ç½‘ç›˜çš„é“¾æ¥åˆ†äº«ï¼Œåˆ†äº«åå…¶ä»–ç”¨æˆ·å¯é€šè¿‡åˆ†äº«å¯†ç æŸ¥çœ‹å¯¹è¯å†…å®¹
- [x] åˆ†äº«å†…å®¹ `é™æ€æ¨¡æ¿æ¸²æŸ“`ï¼Œåˆ©äº SEO
- [x] è‡ªå®šä¹‰ç³»ç»Ÿè§’è‰²ã€åå°ç®¡ç†
- [x] å†…å®¹åˆ†äº«ç®¡ç†ã€å…¬å‘Šç®¡ç† ã€æ›´æ–°è®°å½•ç®¡ç†
- [x] æ¥å…¥æ¨¡å‹ç®¡ç†

> [!NOTE] > **å…·ä½“å…³äºä½¿ç”¨å¾®ä¿¡å…¬ä¼—å·å®ç°ç½‘ç«™æˆæƒç™»å½•çš„æŠ€æœ¯æ–¹æ¡ˆå¯å‚è€ƒå¦‚ä¸‹æ–‡ç« ï¼Œéå¸¸è¯¦ç»†
> [https://juejin.cn/post/7234394174274158650](https://juejin.cn/post/7234394174274158650)**

---

## ç›®å½• <!-- omit in toc -->

- [å‰ç½®è¦æ±‚](#å‰ç½®è¦æ±‚)
  - [Node](#node)
  - [MongoDB](#mongodb)
  - [ç”¨æˆ·é…ç½® æœåŠ¡ç«¯ server ç›®å½•](#ç”¨æˆ·é…ç½®-æœåŠ¡ç«¯-server-ç›®å½•)
    - [MongoURI](#mongouri)
    - [JWT\_SECRET\_KEY](#jwt_secret_key)
    - [MAX\_LENGTH](#max_length)
    - [DAILY\_LIMIT](#daily_limit)
    - [VIP\_MAX\_LENGTH](#vip_max_length)
    - [VIP\_DAILY\_LIMIT](#vip_daily_limit)
    - [SHARE\_MAX\_COUNT](#share_max_count)
    - [WECHAT\_TOKEN](#wechat_token)
  - [ç”¨æˆ·é…ç½® å®¢æˆ·ç«¯ client ç›®å½•](#ç”¨æˆ·é…ç½®-å®¢æˆ·ç«¯-client-ç›®å½•)
    - [ç½‘ç«™ç™»å½• - å…¬ä¼—å·äºŒç»´ç å­˜æ”¾è·¯å¾„](#ç½‘ç«™ç™»å½•---å…¬ä¼—å·äºŒç»´ç å­˜æ”¾è·¯å¾„)
- [åº”ç”¨å†…éƒ¨åˆ†æˆªå›¾å±•ç¤º](#åº”ç”¨å†…éƒ¨åˆ†æˆªå›¾å±•ç¤º)
  - [ğŸ  é¦–é¡µ](#-é¦–é¡µ)
    - [ä¿¡æ¯ä¿®æ”¹](#ä¿¡æ¯ä¿®æ”¹)
    - [æ•°æ®åŒæ­¥](#æ•°æ®åŒæ­¥)
    - [ç³»ç»Ÿè§’è‰²](#ç³»ç»Ÿè§’è‰²)
    - [å†…å®¹åˆ†äº«](#å†…å®¹åˆ†äº«)
  - [åå°ç®¡ç†](#åå°ç®¡ç†)
  - [ç§»åŠ¨ç«¯å…¼å®¹](#ç§»åŠ¨ç«¯å…¼å®¹)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
  - [å®¢æˆ·ç«¯](#å®¢æˆ·ç«¯)
  - [æœåŠ¡ç«¯](#æœåŠ¡ç«¯)
- [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
  - [å®¢æˆ·ç«¯](#å®¢æˆ·ç«¯-1)
  - [æœåŠ¡ç«¯](#æœåŠ¡ç«¯-1)
- [å®‰è£…éƒ¨ç½²](#å®‰è£…éƒ¨ç½²)
  - [æœ¬åœ°å¼€å‘](#æœ¬åœ°å¼€å‘)
- [æœ¬åœ°æ„å»º](#æœ¬åœ°æ„å»º)
  - [Docker](#docker)
- [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
  - [å…¬ä¼—å·ç”¨æˆ·è®¾ç½®ç®¡ç†å‘˜](#å…¬ä¼—å·ç”¨æˆ·è®¾ç½®ç®¡ç†å‘˜)
  - [éå…¬ä¼—å·æˆæƒç™»å½•æ–¹å¼ æ–°å»ºç”¨æˆ·](#éå…¬ä¼—å·æˆæƒç™»å½•æ–¹å¼-æ–°å»ºç”¨æˆ·)
  - [æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·](#æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·)
  - [æ·»åŠ  AI å¤§æ¨¡å‹](#æ·»åŠ -ai-å¤§æ¨¡å‹)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [å…è´£å£°æ˜](#å…è´£å£°æ˜)
- [æ”¯æŒä½œè€…](#æ”¯æŒä½œè€…)
  - [Alipay](#alipay)
  - [Wepay](#wepay)
- [LICENSE](#license)

---

## å‰ç½®è¦æ±‚

### Node

`node` éœ€è¦ `^18 || ^19 || ^20` ç‰ˆæœ¬ï¼ˆ`14 <= node <= 18`çš„éœ€è¦å®‰è£… [fetch polyfill](https://github.com/developit/unfetch#usage-as-a-polyfill)ï¼‰

å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹è‡ªå·±æœ¬æœºçš„ `node` ç‰ˆæœ¬

```bash
node -v
# v18.19.0
```

ä½¿ç”¨ [nvm](https://github.com/nvm-sh/nvm) å¯ç®¡ç†æœ¬åœ°å¤šä¸ª `node` ç‰ˆæœ¬

`Mac` ç”¨æˆ·å¯ä»¥ä½¿ç”¨ `n` æ¥ç®¡ç† node ç‰ˆæœ¬

```bash
brew install n
```

### MongoDB

`EsChatPro` ä½¿ç”¨çš„æ˜¯ `MongoDB` æ•°æ®åº“ï¼Œå…³äº `MongoDB` çš„å®‰è£…ï¼Œç½‘ç»œä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚

### ç”¨æˆ·é…ç½® æœåŠ¡ç«¯ server ç›®å½•

é…ç½®æ–‡ä»¶è¯·å‚è€ƒ `server/.env.example` æ–‡ä»¶

åœ¨æœåŠ¡ç«¯ `server` æ ¹ç›®å½•ä¸­åˆ›å»º `.env` æ–‡ä»¶ï¼Œå¹¶å¤åˆ¶ `.env.example` æ–‡ä»¶å†…å®¹è¿›è¡Œä¿®æ”¹

è¯¦ç»†é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š

#### MongoURI

- **å¿…é¡»**: `true`
- **æè¿°**: è¿æ¥ MongoDB æ•°æ®åº“çš„ URI åœ°å€

#### JWT_SECRET_KEY

- **å¿…é¡»**: `true`
- **æè¿°**: è®¾ç½®ç”¨äºç”¨æˆ·ç™»å½• jwt é‰´æƒçš„ secret keyã€‚

#### MAX_LENGTH

- **å¿…é¡»**: `false`
- **é»˜è®¤å€¼**: `2000`
- **æè¿°**: æ™®é€šç”¨æˆ·å…è®¸çš„æœ€å¤§è¾“å…¥å­—ç¬¦é•¿åº¦ã€‚é»˜è®¤é™åˆ¶ä¸º 2000 å­—ç¬¦ã€‚

#### DAILY_LIMIT

- **å¿…é¡»**: `false`
- **é»˜è®¤å€¼**: `20`
- **æè¿°**: æ™®é€šç”¨æˆ·æ¯æ—¥è°ƒç”¨æ¥å£çš„é¢åº¦ä¸Šé™ã€‚é»˜è®¤è®¾å®šä¸ºæ¯æ—¥æœ€å¤šè°ƒç”¨ `20` æ¬¡ã€‚

#### VIP_MAX_LENGTH

- **å¿…é¡»**: `false`
- **é»˜è®¤å€¼**: `10000`
- **æè¿°**: VIP ç”¨æˆ·å…è®¸çš„æœ€å¤§è¾“å…¥å­—ç¬¦é•¿åº¦ã€‚é»˜è®¤é™åˆ¶ä¸º 10000 å­—ç¬¦ã€‚

#### VIP_DAILY_LIMIT

- **å¿…é¡»**: `false`
- **é»˜è®¤å€¼**: `99`
- **æè¿°**: VIP ç”¨æˆ·æ¯æ—¥è°ƒç”¨æ¥å£çš„é¢åº¦ä¸Šé™ã€‚é»˜è®¤è®¾å®šä¸ºæ¯æ—¥æœ€å¤šè°ƒç”¨ `99` æ¬¡ã€‚

#### SHARE_MAX_COUNT

- **å¿…é¡»**: `false`
- **é»˜è®¤å€¼**: `5`
- **æè¿°**: æ™®é€šç”¨æˆ·åˆ†äº«å†…å®¹æ•°é‡ä¸Šé™ã€‚é»˜è®¤é™åˆ¶ä¸º 5 æ¡ã€‚

#### WECHAT_TOKEN

- **å¿…é¡»**: `true`
- **æè¿°**: å¯¹åº”å¾®ä¿¡å…¬ä¼—å·åå°è®¾ç½®çš„ tokenï¼Œå¯æŒ‰éœ€è‡ªå®šä¹‰ã€‚

### ç”¨æˆ·é…ç½® å®¢æˆ·ç«¯ client ç›®å½•

#### ç½‘ç«™ç™»å½• - å…¬ä¼—å·äºŒç»´ç å­˜æ”¾è·¯å¾„

`client/static/imgs/mp_qrcode.jpg`

è¯·æ³¨æ„ï¼Œå¦‚æœæ˜¯ `Docker` éƒ¨ç½²ï¼Œåˆ™è·¯å¾„å¦‚ä¸‹

`server/clientDist/static/imgs/mp_qrcode.jpg`

## åº”ç”¨å†…éƒ¨åˆ†æˆªå›¾å±•ç¤º

<details>
<summary>
æˆªå›¾è¯·å±•å¼€æŸ¥çœ‹
</summary>

### ğŸ  é¦–é¡µ

![ç”¨æˆ·ç™»å½•](https://static.iiter.cn/article/106ee6fce8ccf2969bc8841e7c3e3463.png)

![é¦–é¡µç›®å½•å±•å¼€](https://static.iiter.cn/article/52bf81b4999c58d7bfbbfbddf9beb0ba.png)

![é¦–é¡µç›®å½•æ”¶èµ·](https://static.iiter.cn/article/0bc35bd4d50a38f330a39cc77bf2f1f2.png)

![æš—é»‘æ¨¡å¼](https://static.iiter.cn/article/299544aeabd67fbeb3c7910b6ae95deb.png)

![å¤šæ¨¡å‹åˆ‡æ¢](https://static.iiter.cn/article/1cd7fd1f5166cdb4e819ceccb0120435.png)

![è¾“å…¥æ¡†å±•å¼€ç¼–è¾‘](https://static.iiter.cn/article/fea9a90870b3e6db432832f4bbf20c4b.png)

![ç½‘ç«™å…¬å‘Š](https://static.iiter.cn/article/1cfa69ba5ed169a3a71a1ecbfa2d8ed4.png)

![ä¼šå‘˜æ¿€æ´»](https://static.iiter.cn/article/dd158c521adbfd2ddaee8f5a2c7bb3d2.png)

#### ä¿¡æ¯ä¿®æ”¹

![æ˜µç§°ä¿®æ”¹](https://static.iiter.cn/article/b0107600b04c309b6b20e22ef8aa4cc8.png)

![å¤´åƒä¿®æ”¹](https://static.iiter.cn/article/1af022cc187c784e0ab2148d9e09f1b4.png)

#### æ•°æ®åŒæ­¥

![æ‹‰å–](https://static.iiter.cn/article/6d2b1c848a230f135757ac61ab78bb5e.png)

![æ¨é€](https://static.iiter.cn/article/845ceb09434aad129ef395ce7d48f015.png)

#### ç³»ç»Ÿè§’è‰²

![å†…ç½®è§’è‰²](https://static.iiter.cn/article/e2755b60bbe04164bb01b958fc34e9a1.png)

![å…¬å¼€](https://static.iiter.cn/article/d9fb85809c327721182833709e9109e1.png)

![è‡ªå®šä¹‰](https://static.iiter.cn/article/5a202cf160de4b4d1708ca810e3a348c.png)

![åˆ›å»ºç³»ç»Ÿè§’è‰²](https://static.iiter.cn/article/c52f0dcaa9177593c03b46113a12e9ce.png)

![ç³»ç»Ÿè§’è‰²å¯è§†åŒ–](https://static.iiter.cn/article/ddf8e98a2f5f94383c5460f7688c02dc.png)

#### å†…å®¹åˆ†äº«

![é“¾æ¥åˆ†äº«](https://static.iiter.cn/article/4cc220c9bf5592042451fce0ac6fbded.png)

![é“¾æ¥åˆ†äº«æˆåŠŸ](https://static.iiter.cn/article/71277336a0e50c4571f2842bc056125a.png)

![è¾“å…¥å¯†ç æ–¹å¯è®¿é—®](https://static.iiter.cn/article/a128ad00ca7ae35ae04325e0e11b631c.png)

![è¾“å…¥å¯†ç åå±•ç¤ºåˆ†äº«å†…å®¹](https://static.iiter.cn/article/c4170d7ba532621290d561ae48c12431.png)

![åˆ†äº«å†…å®¹ç®¡ç†](https://static.iiter.cn/article/53915939a91c87656aa7f417223e1ce6.png)

![æˆªå›¾åˆ†äº«](https://static.iiter.cn/article/d12d653b953400e03bf8065e3f54fccd.png)

![æˆªå›¾æˆåŠŸ](https://static.iiter.cn/article/8bd1c4f7ac8777bb9699555b646f2b12.png)

### åå°ç®¡ç†

![ç»Ÿè®¡åˆ†æ](https://static.iiter.cn/article/d7e41998ee11794e39ea1e80374bf35d.png)

![ç”¨æˆ·ç®¡ç†](https://static.iiter.cn/article/c0275e5107d2abe6638d43d42bfa7234.png)

![ç”¨æˆ·ç®¡ç†-å¼€ä¼šå‘˜](https://static.iiter.cn/article/da6a485dc01ddfa1e3019b856e0e666f.png)

![ç”¨æˆ·ç®¡ç†-è¯¦æƒ…](https://static.iiter.cn/article/867a6f5de2d7ea3ae15280930bcd620a.png)

![ç”¨æˆ·ç®¡ç†-ç”¨æˆ·æŒ‡å®šæ—¥æœŸè°ƒç”¨æ—¶é—´è®°å½•](https://static.iiter.cn/article/6d3444109ed824ac82e6fa1aa3e12208.png)

![å¡å¯†ç®¡ç†](https://static.iiter.cn/article/54f08ab978b705adacea3259d30147b9.png)

![æ‰¹é‡ç”Ÿæˆå¡å¯†](https://static.iiter.cn/article/f4fb7c9ee762696d65f010eca6a33bf1.png)

![ä¼šå‘˜ç®¡ç†](https://static.iiter.cn/article/d55d5b20fd08d595fa066868dbfd875b.png)

![ç³»ç»Ÿè§’è‰²ç®¡ç†](https://static.iiter.cn/article/b171b6a352a8d74088becdabb46fac77.png)

![å…¬å‘Šç®¡ç†](https://static.iiter.cn/article/7091acf584569f3aa48d9539d82894a1.png)

![å†…å®¹åˆ†äº«ç®¡ç†](https://static.iiter.cn/article/9a4e194555192581a480bd089257e9c7.png)

![ç½‘ç«™æ›´æ–°è®°å½•ç»´æŠ¤](https://static.iiter.cn/article/f73e6deb81822a9ddbddb37549bd5c32.png)

![æ¨¡å‹ç®¡ç†](https://static.iiter.cn/article/a18caa0ab0d4aefe78fae3c009f7faba.png)

### ç§»åŠ¨ç«¯å…¼å®¹

<div align="center">
  <img src="https://static.iiter.cn/article/ba3bb0b1acfb0fee1a5bf398844cc468.png" alt="ç§»åŠ¨ç«¯å¯¹è¯ç®¡ç†" style="width: 45%;">
  <img src="https://static.iiter.cn/article/a6df8eb4ce0d41777a7a14442dbce7e7.png" alt="ç§»åŠ¨ç«¯å†…å®¹ç”Ÿæˆ" style="width: 45%;">
  <img src="https://static.iiter.cn/article/3a153818600b530bd60d3b12abf53593.png" alt="ç§»åŠ¨ç«¯å†…å®¹ç”Ÿæˆ" style="width: 45%;">
  <img src="https://static.iiter.cn/article/ad0672cbd74f34b7e1fcc7d67fd35e8e.png" alt="ç§»åŠ¨ç«¯å†…å®¹ç”Ÿæˆ" style="width: 45%;">
  <img src="https://static.iiter.cn/article/31825e42266893c52b29d9e1dd6c68cd.png" alt="ç§»åŠ¨ç«¯å†…å®¹ç”Ÿæˆ" style="width: 45%;">
</div>

</details>

## æŠ€æœ¯æ ˆ

### å®¢æˆ·ç«¯

`Vue3` + `Element Plus` + `Pinia` + `Unocss`

### æœåŠ¡ç«¯

`Express` + `MongoDB`

## ç›®å½•ç»“æ„

### å®¢æˆ·ç«¯

`/src/assets` é™æ€èµ„æº

`/src/components` å…¬å…±ç»„ä»¶

`/src/hooks` å…¬å…± hooks

`/src/router` è·¯ç”±é…ç½®

`/src/service` æ¥å£è¯·æ±‚ã€å“åº”æ‹¦æˆªå™¨

`/src/stores` çŠ¶æ€ç®¡ç†

`/src/utils` å…¨å±€å·¥å…·ç±»

`/src/views` é¡µé¢

### æœåŠ¡ç«¯

`/src/constant` å¸¸é‡

`/src/schema` MongoDB æ•°æ®åº“ schema

`/src/routes` è·¯ç”±

- `/admin` åå°ç®¡ç†ç›®å½•
- `/share` å†…å®¹åˆ†äº«ç›®å½•ã€é™æ€å†…å®¹ç”Ÿæˆ
- `wechat.ts` å…¬ä¼—å·éªŒè¯ã€è·å–éªŒè¯ç ã€ç™»å½•æ ¡éªŒ
- `home.ts` ç”¨æˆ·ç™»å½•çŠ¶æ€æ ¡éªŒã€è·å–ç½‘ç«™å…¬å‘Š
- `chat.ts` å¤§æ¨¡å‹å¯¹è¯
- `user.ts` ç”¨æˆ·ä¿¡æ¯ç›¸å…³
- `notice.ts` ç½‘ç«™å…¬å‘Š
- `timeline.ts` æ—¶é—´çº¿
- `vip.ts` ä¼šå‘˜ç›¸å…³
- `system_role.ts` ç³»ç»Ÿè§’è‰²
- `sync.ts` æ•°æ®åŒæ­¥

`/src/store` node-cache é…ç½®ï¼Œä¸»è¦ç”¨äºéªŒè¯ç çš„ç”ŸæˆåŠæ ¡éªŒ

`/src/utils` å·¥å…·ç±»

`.env.example` é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼Œè¯·åˆ›å»ºè‡ªå·±çš„ `.env` æ–‡ä»¶

`app.ts` æœåŠ¡ç«¯åº”ç”¨å…¥å£ï¼Œå¯é…ç½®ç«¯å£ã€è·¨åŸŸç­‰

## å®‰è£…éƒ¨ç½²

### æœ¬åœ°å¼€å‘

å…‹éš†é¡¹ç›®

```bash
git clone git@github.com:isnl/EsChatPro.git
```

**æœåŠ¡ç«¯**

è¿›å…¥æœåŠ¡ç«¯æ ¹ç›®å½•

```bash
cd server
```

å®‰è£…ä¾èµ–

```bash
npm install
```

**é‡è¦:** æ•°æ®åº“ä¾èµ– `MongoDB` ï¼Œå¼€å‘åŠéƒ¨ç½²ä¹‹å‰éœ€ç¡®ä¿æ•°æ®åº“æ­£å¸¸è¿è¡Œï¼Œä¸”å®Œæˆä¸Šè¿°çš„å‰ç½®è¦æ±‚

å¯åŠ¨æœåŠ¡ç«¯

```bash
npm run dev
```

---

å¯åŠ¨æœåŠ¡ç«¯åï¼ŒæŒ‰å¦‚ä¸‹æ“ä½œæ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼š

æ­¤æ“ä½œä¸ºæ’å…¥ä¸€æ¡ `åå°ç®¡ç†å‘˜æ•°æ®` åŠ `åå°ç®¡ç†åŠ¨æ€è·¯ç”±æ•°æ®`ï¼Œç®¡ç†å‘˜æ•°æ®å¯ä»¥ä¿®æ”¹ï¼ŒåŠ¨æ€è·¯ç”±æ•°æ®ä¸èƒ½ä¿®æ”¹

è„šæœ¬è·¯å¾„ä¸ºï¼š`scripts/init-mongo.js`

```bash
npm run init-mongo
```

**å®¢æˆ·ç«¯**

è¿›å…¥å®¢æˆ·ç«¯æ ¹ç›®å½•

```bash
cd client
```

å®‰è£…ä¾èµ–

```bash
npm install
```

å¯åŠ¨å®¢æˆ·ç«¯

```bash
npm run dev
```

---

## æœ¬åœ°æ„å»º

**å®¢æˆ·ç«¯æ„å»º**

è¿›å…¥å®¢æˆ·ç«¯æ ¹ç›®å½•

```bash
cd client
```

æ‰§è¡Œæ„å»ºå‘½ä»¤

```bash
npm run build
```

æ­¤æ—¶ä¼šåœ¨ `æœåŠ¡ç«¯æ ¹ç›®å½•ä¸‹` ç”Ÿæˆå®¢æˆ·ç«¯çš„æ„å»ºäº§ç‰© `clientDist`

---

**æœåŠ¡ç«¯æ„å»º**

è¿›å…¥æœåŠ¡ç«¯æ ¹ç›®å½•

```bash
cd server
```

æ‰§è¡Œæ„å»ºå‘½ä»¤

```bash
npm run build
```

æ­¤æ—¶ä¼šåœ¨æœåŠ¡ç«¯æ ¹ç›®å½•äº§ç”Ÿä¸¤ä¸ªæ„å»ºäº§ç‰© `app.mjs` å’Œ `app.mjs.map`

æ¥ä¸‹æ¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨æœåŠ¡å³å¯

```bash
npm start
```

å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ `pm2` æ¥å®ˆæŠ¤è¿›ç¨‹ï¼Œé˜²æ­¢è¿›ç¨‹è¢«æ€æ­»

```bash
pm2 start npm --name ai -- start
```

### Docker

```bash
docker pull webpeanut/eschat_pro

docker run -d --name eschat_pro \
  -p 3300:3300  \
  -e MongoURI=mongodb://localhost:27017/eschat \
  -e WECHAT_TOKEN=YOUR_WECHAT_TOKEN \
  -e JWT_SECRET_KEY=YOUR_JWT_SECRET_KEY \
  -e MAX_LENGTH=2000 \
  -e DAILY_LIMIT=20 \
  -e VIP_MAX_LENGTH=10000 \
  -e VIP_DAILY_LIMIT=99 \
  -e SHARE_MAX_COUNT=5 \
  webpeanut/eschat_pro
```

å¦‚æœä½ éœ€è¦æŒ‡å®šå…¶ä»–ç¯å¢ƒå˜é‡ï¼Œè¯·è‡ªè¡Œåœ¨ä¸Šè¿°å‘½ä»¤ä¸­å¢åŠ  -e ç¯å¢ƒå˜é‡=ç¯å¢ƒå˜é‡å€¼ æ¥æŒ‡å®šã€‚

## æ³¨æ„äº‹é¡¹

### å…¬ä¼—å·ç”¨æˆ·è®¾ç½®ç®¡ç†å‘˜

ç”¨è‡ªå·±å¾®ä¿¡æ‰«ç ç™»å½•åï¼Œä½¿ç”¨ `MongoDB Compass` æˆ–å…¶ä»–æ•°æ®åº“ç»ˆç«¯è¿æ¥æ•°æ®åº“ï¼Œåœ¨ `user` é›†åˆä¸­æ‰¾åˆ°è‡ªå·±ï¼Œå¹¶å°† `role` å­—æ®µè®¾ç½®ä¸º 1 å³å¯

### éå…¬ä¼—å·æˆæƒç™»å½•æ–¹å¼ æ–°å»ºç”¨æˆ·

ç”¨ `MongoDB Compass` æˆ–å…¶ä»–æ•°æ®åº“ç»ˆç«¯è¿æ¥æ•°æ®åº“ï¼Œå¹¶åœ¨ `user` é›†åˆä¸­æ–°å¢å¦‚ä¸‹æ•°æ®ï¼Œ`openId` ä¸ºæˆæƒç å­—æ®µï¼Œè‡ªè¡Œç”Ÿæˆï¼Œé•¿åº¦å’Œå†…å®¹éšæœºï¼Œç¡®ä¿å”¯ä¸€æ€§å³å¯ã€‚

```json
{
  "openId": "GA02rPMrA",
  "id": "poRElv1koxGkvYriOlM61",
  "avatar": "E053",
  "name": "GFN1E-ChatGPTer",
  "createdAt": "2024-04-05 15:38:15"
}
```

### æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·

åŒæ ·çš„ï¼Œ `user` é›†åˆä¸­æ–°å¢å¦‚ä¸‹æ•°æ®ï¼Œ`openId` ä¸ºæˆæƒç å­—æ®µï¼Œè‡ªè¡Œç”Ÿæˆï¼Œé•¿åº¦å’Œå†…å®¹éšæœºï¼Œç¡®ä¿å”¯ä¸€æ€§å³å¯ã€‚role å­—æ®µä¸º 1

```json
// role: æƒé™å­—æ®µï¼Œ1ä¸ºç®¡ç†å‘˜ï¼Œ0ä¸ºæ™®é€šç”¨æˆ·ï¼Œé»˜è®¤ä¸ºæ™®é€šç”¨æˆ·
{
  "openId": "GA02rPMrA",
  "id": "poRElv1koxGkvYriOlM61",
  "avatar": "E053",
  "name": "GFN1E-ChatGPTer",
  "createdAt": "2024-04-05 15:38:15",
  "role": 1
}
```

### æ·»åŠ  AI å¤§æ¨¡å‹

è¿›å…¥åå°ç®¡ç† -> æ¨¡å‹ç®¡ç† -> æ–°å»ºæ¨¡å‹

## å¸¸è§é—®é¢˜

`Q`ï¼š éƒ¨ç½²åä¸ºå•¥ä¸æ˜¯æµå¼å“åº”

`A`ï¼š æ£€æŸ¥ `nginx` é…ç½®

```nginx
proxy_buffering off;
chunked_transfer_encoding on;
tcp_nopush on;
tcp_nodelay on;
keepalive_timeout 65;
```

---

`Q`ï¼š æˆæƒç ç™»å½•æ–¹å¼ï¼Œæˆæƒç åœ¨å“ªåˆ›å»ºï¼Ÿ

`A`ï¼š ç³»ç»Ÿè¿è¡Œåï¼Œç”¨ `MongoDB Compass` æˆ–å…¶ä»–æ•°æ®åº“ç»ˆç«¯è¿æ¥æ•°æ®åº“ï¼Œå¹¶åœ¨ `user` é›†åˆä¸­æ–°å¢å¦‚ä¸‹æ•°æ®ï¼Œ`openId` ä¸ºæˆæƒç å­—æ®µï¼Œè‡ªè¡Œç”Ÿæˆï¼Œé•¿åº¦å’Œå†…å®¹éšæœºï¼Œç¡®ä¿å”¯ä¸€æ€§å³å¯ã€‚
å“¦å¯¹äº†ï¼Œå¦‚æœä½ æƒ³ç»™ä½ è‡ªå·±çš„è´¦å·æ·»åŠ ç®¡ç†å‘˜æƒé™ï¼Œè¯·å†æ·»åŠ  role å­—æ®µï¼Œå€¼ä¸º 1

```json
// æƒé™å­—æ®µï¼Œ1ä¸ºç®¡ç†å‘˜ï¼Œ0ä¸ºæ™®é€šç”¨æˆ·
{
  "openId": "GA02rPMrA",
  "id": "poRElv1koxGkvYriOlM61",
  "avatar": "E053",
  "name": "GFN1E-ChatGPTer",
  "createdAt": "2024-04-05 15:38:15",
  "role": 1
}
```

---

`Q`ï¼š é™¤äº†å¾®ä¿¡å…¬ä¼—å·å’Œæˆæƒç ç™»å½•æ–¹å¼å¤–ï¼Œèƒ½ä¸èƒ½è®©ç”¨æˆ·è‡ªå·±æ³¨å†Œè´¦å·è‡ªè¡Œä½¿ç”¨ï¼Ÿ

`A`ï¼š å‚è€ƒ `server/src/schema/user.ts` å’Œ `server/src/routes/user.ts` æ–‡ä»¶ï¼Œè‡ªè¡Œå¼€å‘æ³¨å†Œç›¸å…³åŠŸèƒ½å³å¯

---

`Q`ï¼š èƒ½ä¸èƒ½ç»™æŒ‡å®šçš„ç”¨æˆ·å•ç‹¬è®¾ç½®æ¯æ—¥è°ƒç”¨æ¬¡æ•°å’Œæ–‡æœ¬é•¿åº¦é™åˆ¶ï¼Ÿ

`A`ï¼š éœ€è¦å†™ç‚¹ä»£ç ï¼Œåœ¨åå°ç”¨æˆ·ç®¡ç†ä¸­ï¼Œå°†è°ƒç”¨æ¬¡æ•°å’Œæ–‡æœ¬é•¿åº¦å­—æ®µå­˜å…¥æ•°æ®åº“ä¸­çš„ç”¨æˆ·è¡¨é‡Œã€‚å¹¶åœ¨å¦‚ä¸‹æ–‡ä»¶ä¸­ï¼ˆ`server/src/routes/gpt.ts`ï¼‰ç”¨æˆ·è°ƒç”¨ AI ç”Ÿæˆå†…å®¹çš„æ—¶å€™ï¼Œå…ˆæ ¹æ®ç”¨æˆ· id è·å–åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œå†å°†è°ƒç”¨æ¬¡æ•°å’Œæ–‡æœ¬é•¿åº¦é™åˆ¶æ”¹ä¸ºä»ç”¨æˆ·ä¿¡æ¯ä¸­è·å–çš„æ–¹å¼å³å¯

- process.env.MAX_LENGTH -> ç”¨æˆ·ä¿¡æ¯ä¸­çš„ MAX_LENGTH
- process.env.DAILY_LIMIT -> ç”¨æˆ·ä¿¡æ¯ä¸­çš„ DAILY_LIMIT

---

`Q`ï¼š Docker éƒ¨ç½²ï¼Œå¦‚ä½•æŸ¥çœ‹é•œåƒæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹

`A`ï¼š è¦æŸ¥çœ‹ Docker é•œåƒä¸­çš„å†…å®¹ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

é¦–å…ˆï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ—å‡ºæœ¬åœ°çš„ Docker é•œåƒï¼š

```bash
docker images
```

æ‰¾åˆ°ä½ æƒ³è¦æŸ¥çœ‹çš„é•œåƒçš„ REPOSITORY å’Œ TAGã€‚

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªä¸´æ—¶å®¹å™¨ï¼Œä½¿å¾—ä½ èƒ½å¤Ÿåœ¨å…¶ä¸­æŸ¥çœ‹é•œåƒä¸­çš„æ–‡ä»¶å†…å®¹ï¼š

```
docker run -it --rm webpeanut/eschat_pro sh
```

è¿™å°†åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå¹¶è¿›å…¥å®¹å™¨çš„ shell å‘½ä»¤è¡Œç•Œé¢ã€‚

åœ¨å®¹å™¨çš„å‘½ä»¤è¡Œç•Œé¢ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ Linux å‘½ä»¤æ¥æŸ¥çœ‹é•œåƒä¸­çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚ `ls` å‘½ä»¤æ¥åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶ã€‚

é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä½ å¯ä»¥åœ¨å®¹å™¨ä¸­æŸ¥çœ‹ Docker é•œåƒä¸­çš„æ–‡ä»¶å†…å®¹ã€‚

---

`Q`ï¼š æ²¡æœ‰æœåŠ¡å™¨å’ŒåŸŸåæ€ä¹ˆåŠï¼Ÿ

`A`ï¼š ä¹°ï¼é˜¿é‡Œäº‘ç°åœ¨æœåŠ¡å™¨ä»·æ ¼æ–°è€ç”¨æˆ·éƒ½å¾ˆä¾¿å®œ
2 æ ¸ 4Gï¼Œ5M å›ºå®šå¸¦å®½ï¼Œ80G ESSD Entry ç›˜ä¸€å¹´åªéœ€è¦`199`ï¼ˆä¼ä¸šç”¨æˆ·ï¼‰ï¼Œ2 æ ¸ 2Gï¼Œ3M å›ºå®šå¸¦å®½ï¼Œ40G ESSD Entry ç›˜åªéœ€ `99`(ä¸ªäººä¼ä¸šåŒäº«)  
ä¸æ˜¯å“¥ä»¬ï¼Œè¿™ä»·æ ¼ä½ æ•¢ä¿¡ï¼ï¼ï¼ æœ€é‡è¦çš„æ˜¯ `ç»­è´¹åŒä»·`ï¼Œè¿™ä½ å—å¾—äº†å—ï¼

å½“ç„¶ï¼Œæ–°ç”¨æˆ·æ›´ä¼˜æƒ ï¼Œ`.comåŸŸå + 2æ ¸2G ECSåŒ…å¹´` åªéœ€ `99`ï¼Œ`99` ä½ ä¹°ä¸äº†åƒäºï¼Œä¹°ä¸äº†ä¸Šå½“

[ç‚¹å‡»å³åˆ»è´­ä¹°](https://www.aliyun.com/daily-act/ecs/activity_selection?userCode=56gyhchh)

## å…è´£å£°æ˜

æœ¬ç³»ç»Ÿä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ç›®çš„ä½¿ç”¨ï¼Œåœ¨é€‰æ‹©æ¥å…¥æ¨¡å‹æ—¶ï¼Œè¯·éµå¾ªå½“åœ°æ³•å¾‹æ³•è§„ï¼Œå°Šé‡ä»–äººçš„åˆæ³•æƒç›Šï¼Œä¸å¾—ç”¨äºä»»ä½•è¿æ³•è¿è§„æ´»åŠ¨ã€‚å¦‚å› ä½¿ç”¨æœ¬ç³»ç»Ÿè€Œäº§ç”Ÿçš„ä»»ä½•æ³•å¾‹è´£ä»»ï¼Œç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…ã€‚

## æ”¯æŒä½œè€…

`EsChatPro` æ˜¯ä¸€æ¬¾å®Œå…¨å…è´¹æ— å¹¿å‘Šçš„å¼€æºè½¯ä»¶ï¼Œè½¯ä»¶å¼€å‘å’Œç»´æŠ¤å…¨é ä½œè€…ç”¨çˆ±å‘ç”µï¼Œå› æ­¤æ‚¨å¯ä»¥é€‰æ‹©æ”¯æŒä½œè€…è®©ä½œè€…æœ‰æ›´å¤šçš„çƒ­æƒ…å’Œç²¾åŠ›ç»´æŠ¤æ­¤è½¯ä»¶ï¼Œæˆ–è€…æ‚¨ä½¿ç”¨äº†æ­¤è½¯ä»¶è¿›è¡Œäº†ç›ˆåˆ©ï¼Œæ¬¢è¿æ‚¨é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ”¯æŒä½œè€…ï¼š

### Alipay

<img src="https://static.iiter.cn/alipay.jpg" width="200" style="margin-right: 100px;"/>

### Wepay

<img src="https://static.iiter.cn/wepay.jpg" width="200" />

## LICENSE

[MIT](https://opensource.org/license/mit/)


